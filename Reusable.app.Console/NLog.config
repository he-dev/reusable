<?xml version="1.0" encoding="utf-8" ?>
<nlog
  xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  internalLogFile="c:\temp\Reusable.apps.Console.log"
  internalLogLevel="Error">

  <!-- *** This file was autogenerated on 17/11/2018 10:42:32 (UTC) *** -->
  <!-- *** Any modifications can be lost. *** -->

  <!-- sub-templates -->

  <variable name="environmentNotAvailable" value="N/A" />
  <variable name="environmentLayout" value="${whenEmpty:whenEmpty=${environmentNotAvailable}:inner=${event-context:item=Environment}}" />

  <variable name="callsiteLayout" value="${callsite:className=true:fileName=true:methodName:true}" />
  <variable name="exceptionLayout" value="${exception:format=tostring:separator= | :innerFormat=tostring,message:maxInnerExceptionLevel=7:innerExceptionSeparator= | }" />
  <variable name="stackTraceLayout" value="${stacktrace:format=raw:topFrames=7:separator= » }" />

  <!-- full templates -->  

  <variable name="debuggerLayout" value="Wiretap » ${event-properties:item=timestamp} | ${event-properties:item=status} | ${event-properties:item=details} | ${onexception:${newline}${exceptionLayout}}" />

    <targets>    

    <target xsi:type="Debugger" name="debugger" layout="${debuggerLayout}" />
        
    <!-- <target  -->
    <!--     xsi:type="Database"  -->
    <!--     name="Test_SemLog3" -->
    <!--     keepConnection="false" -->
    <!--     useTransactions="false" -->
    <!--     dbProvider="Microsoft.Data.Sqlite.SqliteConnection, Microsoft.Data.Sqlite"  -->
    <!--     connectionString="Data Source=c:\\.stuff\\a\\temp\\reusable.sqlite;"> -->
    <target xsi:type="Database" name="Test_SemLog3">
        <connectionString>data source=localhost;initial catalog=master;User Id=SA;Password=blub123!;TrustServerCertificate=True;</connectionString>
        <commandText>
            insert into wiretap_log (
                [prevId],
                [nodeId],
                [instance],
                [timestamp],
                [scope],
                [status],
                [level],
                [elapsed],
                [details],
                [attachment]
            ) VALUES (
                NULLIF(@prevId, ''),
                @nodeId,
                'Reusable.apps.Console',
                @timestamp,
                @scope,
                @status,
                @level,
                @elapsed,
                NULLIF(@details, ''),
                NULLIF(@attachment,'')
            )
        </commandText>
    
        <parameter name="@timestamp" layout="${event-properties:item=timestamp:format=yyyy-MM-dd HH\:mm\:ss.fff}" />
        <parameter name="@prevId" layout="${event-properties:item=prevId}" />
        <parameter name="@nodeId" layout="${event-properties:item=nodeId}" />
        <parameter name="@scope" layout="${event-properties:item=scope}" />
        <parameter name="@status" layout="${event-properties:item=status:lowercase=true}" />
        <parameter name="@level" layout="${event-properties:item=level:lowercase=true}" />
        <parameter name="@elapsed" layout="${event-properties:item=elapsed}" />
        <parameter name="@details" layout="${event-properties:item=details}" />
        <parameter name="@attachment" layout="${event-properties:item=attachment}" />
    </target>

  </targets>

  <rules>

    <!-- Log everything to debugger -->
    <logger name="*" minlevel="Debug" writeTo="debugger" enabled="false" final="false" />

    <logger name="Test_SemLog3" xsi:appendTo="Test_SemLog3" minlevel="Debug" enabled="true" final="false" />
   
    <!-- Use the fallbackLog if no other log matches. -->
    <logger name="*" xsi:appendTo="Test_SemLog3" minlevel="Debug" enabled="true" final="false" />

  </rules>
</nlog>

